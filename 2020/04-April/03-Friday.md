## 计划任务

- [x] 跟进媒资 v1.4.9 迭代

  今天杂事较少，已将进度赶回来。

- [x] 跟进 PC 官网埋点和部署

  已跟运维沟通清楚部署事项

  关于 Nuxt 项目 universal 模式部署方式，一台发布机器，两台运行服务器。

  发布机器用来拉取项目代码、全量安装依赖、构建应用程序服务文件，然后将 `.nuxt/`、`server/`、`.npmrc`、`ecosystem.config.js`、`nuxt.config.js`、`package.json` 复制到两台运行服务器。

  运行服务器拿到上述内容，通过 `yarn install --production` 仅安装 dependencies 依赖，然后运行 pm2 相关命令启动或重启服务。

  部署过程，必须保证一台运行服务器处于运行状态，不可全部停服部署。  
  安全策略，任何一台服务出现响应时间较长或 http 状态码为 4 或 5 开头，则 Nginx 将流量打向其它运行服务器。

## 工作周报

本周解决落地页的两个线上小问题：
1、先购买再提交表单的落地页，用户支付之后未填写表单，第二天再打开落地页会出现刷新很多次的情况。
2、先提交表单再购买的落地页，极少部分用户填写表单之后会出现页面空白。
落地页 v2 势在必行，除了解决 v1 存在的现有问题，还规划支持多表单、多商品、表单和微信共存等特性。

PC 官网项目在假期前做过一次 code review，目前还瞧不出什么大问题，因为还有很多特性没有完成。埋点统计模块的插件虽然已经在清明假期加班完成，但是由于忘记内网 npm 账号和密码，还没有发布到 npm 仓库。而本地接入出现了一些未知的问题，所以暂时还没有跑通。
官网的前端部署跟运维做过细致沟通，整个部署过程很清晰，双方信息和理解一直。负责部署的两位新人同事感觉还是很给力的，因为听到了一句让人很放心的话：“这些你都不用管，我们来搞定”。其实在跟他们对接之前，我已经写好了详细的部署方式和步骤，以及相关配置文件和构建的脚本命令，只需要他们再配合写一下发布脚本就好了。结果是我多虑了，完全不用我操心这些事情，感觉很棒。

银河系统的前端由 @彭泽华 负责，目前了解到的情况是在可控范围之内。
CRM 系统的内容迁移并不简单，因为框架调整的原因，之前的一些设计方案无法直接照搬，需要调整的地方还是很多的。
清明加班跟银河后端沟通的方案会在假期之后第一时间跟 @彭泽华 同步，看是否还有我未考虑到的问题点。
